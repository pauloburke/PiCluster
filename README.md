# PiCluster
Code and Documentation for setting up a RaspberryPi Cluster


## Installing Ubuntu Server image on SD Card

1. Download Ubuntu Server for Raspberry Pi from this [link](https://ubuntu.com/download/raspberry-pi) (Used version 22.04.3 LTS at the time of writing).
2. Follow the steps on this [tutorial](https://ubuntu.com/tutorials/how-to-install-ubuntu-on-your-raspberry-pi) to write the image to an SD card.
    > Make sure you edit the install configuration by setting up a hostname, user, and wifi connections if necessary.


## Setting up common configurations for Master and Workers

1. Update Ubuntu

```bash
sudo apt update && sudo apt dist-upgrade -y
```

2. Add the following configuration:
```bash
sudo vim /boot/firmware/cmdline.txt
```
Add the following to the end of the line:
```bash
cgroup_enable=memory cgroup_memory=1
```

3. Reboot
```bash
sudo reboot
```

4. Install MicroK8s
```bash
sudo snap install microk8s --classic
```

## Setting up Master Node

1. Enable MicroK8s addons
```bash
sudo microk8s enable dns dashboard helm hostpath-storage
```

2. Check if MicroK8s is running
```bash
sudo microk8s status --wait-ready
```

5. Create master node
```bash
sudo microk8s.add-node
```

6. Save the join command and token generated by the previous command.

## Setting up Worker Nodes

1. To join the cluster, run the join command and token generated by the master node.
```bash
sudo microk8s join <master-node-ip>:<master-node-port>/<token>
```